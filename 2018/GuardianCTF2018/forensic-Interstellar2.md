# Forensic - Interstellar2

## 문제
Interstellar1을 해결하면 플래그가 담긴 사진과 동시에 레벨2의 문제가 주어진다. 문제는 압축이 걸려있고, 안에 사진이 한장 있다. 압축파일은 비밀번호가 걸려있다.

## 접근1 (삽질)
압축파일의 비밀번호를 모르지만 CTF에서는 부르트포스 문제가 잘 나오지 않는다.(사실 본적이 없다) 그래서 ZIP파일과 시그니처가 같은 DOC로 확장자를 바꿔보았지만 잘 열리지 않았다. 지금생각해보면 ZIP 파일 안에 JPG 파일이 있는것을 확인했음에도 왜 이런 생각을 했을까 싶다..

## 접근2 (삽질)
혹시나 ZIP파일 HEX에 패스워드 값이 숨겨져있지 않을까 생각하여 한참을 뒤졌지만 아무것도 나오지 않았다.

## 접근3 (삽질)
혹시나 원래 비밀번호가 없는데 단순히 플래그를 변경해서 비밀번호가 있는것처럼 보이게 한것을 아닐까 생각해서 HxD로 열어 FLAG의 첫번째 비트를 바꾸어주었지만 효과가 없는듯 하다.

## 접근4
해결방법은 의외로 간단했다....;; Interstellar1의 플래그를 넣으면 풀렸다..ㅎ 압축을 풀고나니 또 사진한장이 보였다. 바로 HxD로 열어보니 가장 아래에 의심스러운 문구들이 등장한다.  
```DO_YOU_WANT_FLAG?HvbsejboDUG|Fw4sz`82nf`J`Tff`V`J`5bmm`2o`MPWF`bMM`1wFs`BhbJo~```

## 접근5 (삽질)
플래그를 원한다면 저 문구를 해결해야한다. 정말 바보같은 접근이었지만 base64 인코딩을 생각했다. 요즘 이 인코딩이 자주나와서.... 특수문자를 모두 지우고 디크립터를 돌려보니 잘 안됐다. 심지어 글자수를 좀 줄여보기도 했다... 밤새고 새벽 5시였으니 나를 용서해주자

## 접근6
뭔지는 잘 모르겠지만 우선 저 알 수 없는 문자들이 아마 플래그를 도출할 문구라는것은 예상하고 있었다. 잘 살펴보면 요상한 문구에 특수문자는 ```|``` 한개와 중간중간에 껴있는 ```백쿼터``` 여러개, 마지막에 존재하는 ```~```. 이 모습이 흡사 플래그의 ```{ _ }``` 포맷과 닮았다. 또한, 가장 앞글자인 ```H```와 특수문자 ```|```가 나오기 전 세글자 ```DUG```는 Guardian의 ```G```와 ```CTF```를 닮았다. 카이사르 암호가 가장 먼저 떠올랐고, H와 G 사이의 거리는 -1 이므로 간단하게 코딩을 했다.

## 해결
``` python
a = "HvbsejboDUG|Fw4sz`82nf`J`Tff`V`J`5bmm`2o`MPWF`bMM`1wFs`BhbJo~"
for i in a:
    print(chr(ord(i)-1), end ='')
```
실행해보니 아름답게 플래그를 뱉어냈다.